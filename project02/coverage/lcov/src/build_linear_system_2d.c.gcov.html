<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - Project 1 - src/build_linear_system_2d.c</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../index.html">top level</a> - <a href="index.html">src</a> - build_linear_system_2d.c<span style="font-size: 80%;"> (source / <a href="build_linear_system_2d.c.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">Project 1</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">235</td>
            <td class="headerCovTableEntry">238</td>
            <td class="headerCovTableEntryHi">98.7 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2018-12-14 22:06:44</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /******************************************************************</a>
<span class="lineNum">       2 </span>            :  * This function builds the linear system in two dimensional case
<span class="lineNum">       3 </span>            :  * ***************************************************************/
<span class="lineNum">       4 </span>            : 
<span class="lineNum">       5 </span>            : #include &lt;stdio.h&gt;
<span class="lineNum">       6 </span>            : #include &lt;stdlib.h&gt;
<span class="lineNum">       7 </span>            : #include &lt;string.h&gt;
<span class="lineNum">       8 </span>            : #include &lt;grvy.h&gt;
<span class="lineNum">       9 </span>            : #include &lt;masa.h&gt;
<span class="lineNum">      10 </span>            : #include &quot;laplace.h&quot;
<a name="11"><span class="lineNum">      11 </span>            : #include &quot;function.h&quot;</a>
<span class="lineNum">      12 </span>            : 
<span class="lineNum">      13 </span><span class="lineCov">          3 : void build_linear_system_2d(Laplace* solver) {</span>
<span class="lineNum">      14 </span>            : 
<span class="lineNum">      15 </span><span class="lineCov">          3 :     grvy_timer_begin(__func__);</span>
<span class="lineNum">      16 </span>            : 
<span class="lineNum">      17 </span><span class="lineCov">          3 :     printf(&quot;** Building two dimensional linear system...\n&quot;);</span>
<span class="lineNum">      18 </span><span class="lineCov">          3 :     printf(&quot;--&gt; Enforcing analytic Dirichlet BCs using MASA (2D)\n\n\n&quot;);</span>
<span class="lineNum">      19 </span>            : 
<span class="lineNum">      20 </span><span class="lineCov">          3 :     if(solver-&gt;output_mode == 1) {</span>
<span class="lineNum">      21 </span><span class="lineNoCov">          0 :         printf(&quot;[debug]: build linear system - function begin\n\n\n&quot;);</span>
<span class="lineNum">      22 </span>            :     }
<span class="lineNum">      23 </span>            : 
<span class="lineNum">      24 </span><span class="lineCov">          3 :     int N = solver-&gt;nx;</span>
<span class="lineNum">      25 </span><span class="lineCov">          3 :     double h = solver-&gt;h;</span>
<span class="lineNum">      26 </span><span class="lineCov">          3 :     double k = solver-&gt;k;</span>
<span class="lineNum">      27 </span><span class="lineCov">          3 :     double c = h*h/k;</span>
<span class="lineNum">      28 </span><span class="lineCov">          3 :     double xmin = solver-&gt;xmin;</span>
<span class="lineNum">      29 </span><span class="lineCov">          3 :     double xmax = solver-&gt;xmax;</span>
<span class="lineNum">      30 </span><span class="lineCov">          3 :     double ymin = solver-&gt;ymin;</span>
<span class="lineNum">      31 </span><span class="lineCov">          3 :     double ymax = solver-&gt;ymax;</span>
<span class="lineNum">      32 </span>            : 
<span class="lineNum">      33 </span>            :     // initialize and set parameters of the masa. 
<span class="lineNum">      34 </span>            :     // This can give the value of the right sided function and the boundary condition
<span class="lineNum">      35 </span><span class="lineCov">          3 :     masa_init(&quot;nick&quot;,&quot;heateq_2d_steady_const&quot;);</span>
<span class="lineNum">      36 </span><span class="lineCov">          3 :     masa_set_param(&quot;A_x&quot;, 10.0);</span>
<span class="lineNum">      37 </span><span class="lineCov">          3 :     masa_set_param(&quot;B_y&quot;, 10.0);</span>
<span class="lineNum">      38 </span><span class="lineCov">          3 :     masa_set_param(&quot;k_0&quot;, k);</span>
<span class="lineNum">      39 </span>            : 
<span class="lineNum">      40 </span>            :     // set the matrix values, matrix index, non-zero numbers of each row, right sided vector values and boundary conditions
<span class="lineNum">      41 </span><span class="lineCov">          3 :     if(solver-&gt;fd_method == 2) {</span>
<span class="lineNum">      42 </span>            :         // case of second order scheme
<span class="lineNum">      43 </span>            :         // 
<span class="lineNum">      44 </span>            :         // set the parameters of first block row
<span class="lineNum">      45 </span>            :         // set the parameters for fisrt row of first block row
<span class="lineNum">      46 </span><span class="lineCov">          2 :         solver-&gt;matrix_value[0] = (double *)malloc(3*sizeof(double));</span>
<span class="lineNum">      47 </span><span class="lineCov">          2 :         memcpy(solver-&gt;matrix_value[0], (double [3]){ 4, -1, -1}, 3*sizeof(double));</span>
<span class="lineNum">      48 </span><span class="lineCov">          2 :         solver-&gt;matrix_index[0] = (int *)malloc(3*sizeof(int));</span>
<span class="lineNum">      49 </span><span class="lineCov">          2 :         memcpy(solver-&gt;matrix_index[0], (int [3]){ 0, 1, N-1}, 3*sizeof(int));</span>
<span class="lineNum">      50 </span><span class="lineCov">          2 :         solver-&gt;length[0] = 3;</span>
<span class="lineNum">      51 </span><span class="lineCov">          2 :         solver-&gt;rht_vec[0] = masa_eval_2d_source_t(xmin+h, ymin+h)*c + masa_eval_2d_exact_t(xmin, ymin+h) + masa_eval_2d_exact_t(xmin+h, ymin);</span>
<span class="lineNum">      52 </span>            : 
<span class="lineNum">      53 </span>            :         // set the parameters for inner rows of first blcok row
<span class="lineNum">      54 </span><span class="lineCov">        196 :         for(int j = 1; j &lt; N-2; j++) {</span>
<span class="lineNum">      55 </span><span class="lineCov">        194 :             solver-&gt;matrix_value[j] = (double *)malloc(4*sizeof(double));</span>
<span class="lineNum">      56 </span><span class="lineCov">        194 :             memcpy(solver-&gt;matrix_value[j], (double [4]){ -1, 4, -1, -1}, 4*sizeof(double));</span>
<span class="lineNum">      57 </span><span class="lineCov">        194 :             solver-&gt;matrix_index[j] = (int *)malloc(4*sizeof(int));</span>
<span class="lineNum">      58 </span><span class="lineCov">        194 :             memcpy(solver-&gt;matrix_index[j], (int [4]){ j-1, j, j+1, N-1+j}, 4*sizeof(int));</span>
<span class="lineNum">      59 </span><span class="lineCov">        194 :             solver-&gt;length[j] = 4;</span>
<span class="lineNum">      60 </span><span class="lineCov">        194 :             solver-&gt;rht_vec[j] = masa_eval_2d_source_t(xmin+(j+1)*h, ymin+h)*c + masa_eval_2d_exact_t(xmin+(j+1)*h, ymin);</span>
<span class="lineNum">      61 </span>            :         }
<span class="lineNum">      62 </span>            : 
<span class="lineNum">      63 </span>            :         // set the parameters for last row of first block row
<span class="lineNum">      64 </span><span class="lineCov">          2 :         solver-&gt;matrix_value[N-2] = (double *)malloc(3*sizeof(double));</span>
<span class="lineNum">      65 </span><span class="lineCov">          2 :         memcpy(solver-&gt;matrix_value[N-2], (double [3]){ -1, 4, -1}, 3*sizeof(double));</span>
<span class="lineNum">      66 </span><span class="lineCov">          2 :         solver-&gt;matrix_index[N-2] = (int *)malloc(3*sizeof(int));</span>
<span class="lineNum">      67 </span><span class="lineCov">          2 :         memcpy(solver-&gt;matrix_index[N-2], (int [3]){ N-3, N-2, 2*N-3}, 3*sizeof(int));</span>
<span class="lineNum">      68 </span><span class="lineCov">          2 :         solver-&gt;length[N-2] = 3;</span>
<span class="lineNum">      69 </span><span class="lineCov">          2 :         solver-&gt;rht_vec[N-2] = masa_eval_2d_source_t(xmin+(N-1)*h, ymin+h)*c + masa_eval_2d_exact_t(xmin+(N-1)*h, ymin) + masa_eval_2d_exact_t(xmax, ymin+h);</span>
<span class="lineNum">      70 </span>            :     
<span class="lineNum">      71 </span>            :         //
<span class="lineNum">      72 </span>            :         // set the parameters of inner block rows
<span class="lineNum">      73 </span><span class="lineCov">        196 :         for(int i = 1; i &lt; N-2; i++) {</span>
<span class="lineNum">      74 </span>            :             // set the parameters for first row of inner block rows
<span class="lineNum">      75 </span><span class="lineCov">        194 :             solver-&gt;matrix_value[i*(N-1)] = (double *)malloc(4*sizeof(double));</span>
<span class="lineNum">      76 </span><span class="lineCov">        194 :             memcpy(solver-&gt;matrix_value[i*(N-1)], (double [4]){ -1, 4, -1, -1}, 4*sizeof(double));</span>
<span class="lineNum">      77 </span><span class="lineCov">        194 :             solver-&gt;matrix_index[i*(N-1)] = (int *)malloc(4*sizeof(int));</span>
<span class="lineNum">      78 </span><span class="lineCov">        194 :             memcpy(solver-&gt;matrix_index[i*(N-1)], (int [4]){ (i-1)*(N-1), i*(N-1), i*(N-1)+1, (i+1)*(N-1)}, 4*sizeof(int));</span>
<span class="lineNum">      79 </span><span class="lineCov">        194 :             solver-&gt;length[i*(N-1)] = 4;</span>
<span class="lineNum">      80 </span><span class="lineCov">        194 :             solver-&gt;rht_vec[i*(N-1)] = masa_eval_2d_source_t(xmin+h, ymin+(i+1)*h)*c + masa_eval_2d_exact_t(xmin, ymin+(i+1)*h);</span>
<span class="lineNum">      81 </span>            : 
<span class="lineNum">      82 </span>            :             // set the parameters for inner rows of inner block rows
<span class="lineNum">      83 </span><span class="lineCov">      19012 :             for(int j = 1; j &lt; N-2; j++) {</span>
<span class="lineNum">      84 </span><span class="lineCov">      18818 :                 solver-&gt;matrix_value[i*(N-1)+j] = (double *)malloc(5*sizeof(double));</span>
<span class="lineNum">      85 </span><span class="lineCov">      18818 :                 memcpy(solver-&gt;matrix_value[i*(N-1)+j], (double [5]){ -1, -1, 4, -1, -1}, 5*sizeof(double));</span>
<span class="lineNum">      86 </span><span class="lineCov">      18818 :                 solver-&gt;matrix_index[i*(N-1)+j] = (int *)malloc(5*sizeof(int));</span>
<span class="lineNum">      87 </span><span class="lineCov">      18818 :                 memcpy(solver-&gt;matrix_index[i*(N-1)+j], (int [5]){ (i-1)*(N-1)+j, i*(N-1)+j-1, i*(N-1)+j, i*(N-1)+j+1, (i+1)*(N-1)+j}, 5*sizeof(int));</span>
<span class="lineNum">      88 </span><span class="lineCov">      18818 :                 solver-&gt;length[i*(N-1)+j] = 5;</span>
<span class="lineNum">      89 </span><span class="lineCov">      18818 :                 solver-&gt;rht_vec[i*(N-1)+j] = masa_eval_2d_source_t(xmin+(j+1)*h, ymin+(i+1)*h)*c;</span>
<span class="lineNum">      90 </span>            :             }
<span class="lineNum">      91 </span>            : 
<span class="lineNum">      92 </span>            :             // set the parameters for last row of inner block rows
<span class="lineNum">      93 </span><span class="lineCov">        194 :             solver-&gt;matrix_value[i*(N-1)+N-2] = (double *)malloc(4*sizeof(double));</span>
<span class="lineNum">      94 </span><span class="lineCov">        194 :             memcpy(solver-&gt;matrix_value[i*(N-1)+N-2], (double [4]){ -1, -1, 4, -1}, 4*sizeof(double));</span>
<span class="lineNum">      95 </span><span class="lineCov">        194 :             solver-&gt;matrix_index[i*(N-1)+N-2] = (int *)malloc(4*sizeof(int));</span>
<span class="lineNum">      96 </span><span class="lineCov">        194 :             memcpy(solver-&gt;matrix_index[i*(N-1)+N-2], (int [4]){ (i-1)*(N-1)+N-2, i*(N-1)+N-3, i*(N-1)+N-2, (i+1)*(N-1)+N-2}, 4*sizeof(int));</span>
<span class="lineNum">      97 </span><span class="lineCov">        194 :             solver-&gt;length[i*(N-1)+N-2] = 4;</span>
<span class="lineNum">      98 </span><span class="lineCov">        194 :             solver-&gt;rht_vec[i*(N-1)+N-2] = masa_eval_2d_source_t(xmin+(N-1)*h, ymin+(i+1)*h)*c + masa_eval_2d_exact_t(xmax, ymin+(i+1)*h);</span>
<span class="lineNum">      99 </span>            : 
<span class="lineNum">     100 </span>            :         }
<span class="lineNum">     101 </span>            : 
<span class="lineNum">     102 </span>            :         //
<span class="lineNum">     103 </span>            :         // set the parameters of last block row
<span class="lineNum">     104 </span>            :         // set the parameters for first row of last block row
<span class="lineNum">     105 </span><span class="lineCov">          2 :         solver-&gt;matrix_value[(N-2)*(N-1)] = (double *)malloc(3*sizeof(double));</span>
<span class="lineNum">     106 </span><span class="lineCov">          2 :         memcpy(solver-&gt;matrix_value[(N-2)*(N-1)], (double [3]){ -1, 4, -1}, 3*sizeof(double));</span>
<span class="lineNum">     107 </span><span class="lineCov">          2 :         solver-&gt;matrix_index[(N-2)*(N-1)] = (int *)malloc(3*sizeof(int));</span>
<span class="lineNum">     108 </span><span class="lineCov">          2 :         memcpy(solver-&gt;matrix_index[(N-2)*(N-1)], (int [3]){ (N-1)*(N-1)+2-2*N, (N-1)*(N-1)+1-N, (N-1)*(N-1)+2-N}, 3*sizeof(int));</span>
<span class="lineNum">     109 </span><span class="lineCov">          2 :         solver-&gt;length[(N-2)*(N-1)] = 3;</span>
<span class="lineNum">     110 </span><span class="lineCov">          2 :         solver-&gt;rht_vec[(N-2)*(N-1)] = masa_eval_2d_source_t(xmin+h, ymin+(N-1)*h)*c + masa_eval_2d_exact_t(xmin, ymin+(N-1)*h) + masa_eval_2d_exact_t(xmin+h, ymax);</span>
<span class="lineNum">     111 </span>            : 
<span class="lineNum">     112 </span>            :         // set the parameters for inner rows of last block row
<span class="lineNum">     113 </span><span class="lineCov">        196 :         for(int j = 1; j &lt; N-2; j++) {</span>
<span class="lineNum">     114 </span><span class="lineCov">        194 :             solver-&gt;matrix_value[(N-2)*(N-1)+j] = (double *)malloc(4*sizeof(double));</span>
<span class="lineNum">     115 </span><span class="lineCov">        194 :             memcpy(solver-&gt;matrix_value[(N-2)*(N-1)+j], (double [4]){ -1, -1, 4, -1}, 4*sizeof(double));</span>
<span class="lineNum">     116 </span><span class="lineCov">        194 :             solver-&gt;matrix_index[(N-2)*(N-1)+j] = (int *)malloc(4*sizeof(int));</span>
<span class="lineNum">     117 </span><span class="lineCov">        194 :             memcpy(solver-&gt;matrix_index[(N-2)*(N-1)+j], (int [4]){ (N-1)*(N-1)+2-2*N+j, (N-1)*(N-1)-N+j, (N-1)*(N-1)-N+j+1, (N-1)*(N-1)-N+j+2}, 4*sizeof(int));</span>
<span class="lineNum">     118 </span><span class="lineCov">        194 :             solver-&gt;length[(N-2)*(N-1)+j] = 4;</span>
<span class="lineNum">     119 </span><span class="lineCov">        194 :             solver-&gt;rht_vec[(N-2)*(N-1)+j] = masa_eval_2d_source_t(xmin+(j+1)*h, ymin+(N-1)*h)*c + masa_eval_2d_exact_t(xmin+(j+1)*h, ymax);</span>
<span class="lineNum">     120 </span>            :         }
<span class="lineNum">     121 </span>            : 
<span class="lineNum">     122 </span>            :         // set the parameters for last row of last block row
<span class="lineNum">     123 </span><span class="lineCov">          2 :         solver-&gt;matrix_value[N*(N-2)] = (double *)malloc(3*sizeof(double));</span>
<span class="lineNum">     124 </span><span class="lineCov">          2 :         memcpy(solver-&gt;matrix_value[N*(N-2)], (double [3]){ -1, -1, 4}, 3*sizeof(double));</span>
<span class="lineNum">     125 </span><span class="lineCov">          2 :         solver-&gt;matrix_index[N*(N-2)] = (int *)malloc(3*sizeof(int));</span>
<span class="lineNum">     126 </span><span class="lineCov">          2 :         memcpy(solver-&gt;matrix_index[N*(N-2)], (int [3]){ (N-1)*(N-1)-N, (N-1)*(N-1)-2, (N-1)*(N-1)-1}, 3*sizeof(int));</span>
<span class="lineNum">     127 </span><span class="lineCov">          2 :         solver-&gt;length[N*(N-2)] = 3;</span>
<span class="lineNum">     128 </span><span class="lineCov">          2 :         solver-&gt;rht_vec[N*(N-2)] = masa_eval_2d_source_t(xmin+(N-1)*h, ymin+(N-1)*h)*c + masa_eval_2d_exact_t(xmax, ymin+(N-1)*h) + masa_eval_2d_exact_t(xmin+(N-1)*h, ymax);</span>
<span class="lineNum">     129 </span>            : 
<span class="lineNum">     130 </span>            :     } else {
<span class="lineNum">     131 </span>            :         // case of fourth order scheme
<span class="lineNum">     132 </span>            :         // 
<span class="lineNum">     133 </span>            :         // set the parameters of first block row
<span class="lineNum">     134 </span>            :         // set the parameters for first row of first block row
<span class="lineNum">     135 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[0] = (double *)malloc(5*sizeof(double));</span>
<span class="lineNum">     136 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[0], (double [5]){ 60, -16, 1, -16, 1}, 5*sizeof(double));</span>
<span class="lineNum">     137 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[0] = (int *)malloc(5*sizeof(int));</span>
<span class="lineNum">     138 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[0], (int [5]){ 0, 1, 2, N-1, 2*(N-1)}, 5*sizeof(int));</span>
<span class="lineNum">     139 </span><span class="lineCov">          1 :         solver-&gt;length[0] = 5;</span>
<span class="lineNum">     140 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[0] = masa_eval_2d_source_t(xmin+h, ymin+h)*12*c + 16*masa_eval_2d_exact_t(xmin, ymin+h) + 16*masa_eval_2d_exact_t(xmin+h, ymin) - masa_eval_2d_exact_t(xmin-h, ymin+h) - masa_eval_2d_exact_t(xmin+h, ymin-h);</span>
<span class="lineNum">     141 </span>            : 
<span class="lineNum">     142 </span>            :         // set the parameters for second row of first block row
<span class="lineNum">     143 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[1] = (double *)malloc(6*sizeof(double));</span>
<span class="lineNum">     144 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[1], (double [6]){ -16, 60, -16, 1, -16, 1}, 6*sizeof(double));</span>
<span class="lineNum">     145 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[1] = (int *)malloc(6*sizeof(int));</span>
<span class="lineNum">     146 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[1], (int [6]){ 0, 1, 2, 3, N, 2*N-1}, 6*sizeof(int));</span>
<span class="lineNum">     147 </span><span class="lineCov">          1 :         solver-&gt;length[1] = 6;</span>
<span class="lineNum">     148 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[1] = masa_eval_2d_source_t(xmin+2*h, ymin+h)*12*c + 16*masa_eval_2d_exact_t(xmin+2*h, ymin) - masa_eval_2d_exact_t(xmin, ymin+h) - masa_eval_2d_exact_t(xmin+2*h, ymin-h);</span>
<span class="lineNum">     149 </span>            : 
<span class="lineNum">     150 </span>            :         // set the parameters for inner rows of first block row
<span class="lineNum">     151 </span><span class="lineCov">         96 :         for(int j = 2; j &lt; N-3; j++) {</span>
<span class="lineNum">     152 </span><span class="lineCov">         95 :             solver-&gt;matrix_value[j] = (double *)malloc(7*sizeof(double));</span>
<span class="lineNum">     153 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_value[j], (double [7]){ 1, -16, 60, -16, 1, -16, 1}, 7*sizeof(double));</span>
<span class="lineNum">     154 </span><span class="lineCov">         95 :             solver-&gt;matrix_index[j] = (int *)malloc(7*sizeof(int));</span>
<span class="lineNum">     155 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_index[j], (int [7]){ j-2, j-1, j, j+1, j+2, N-1+j, 2*N-2+j}, 7*sizeof(int));</span>
<span class="lineNum">     156 </span><span class="lineCov">         95 :             solver-&gt;length[j] = 7;</span>
<span class="lineNum">     157 </span><span class="lineCov">         95 :             solver-&gt;rht_vec[j] = masa_eval_2d_source_t(xmin+(j+1)*h, ymin+h)*12*c + 16*masa_eval_2d_exact_t(xmin+(j+1)*h, ymin) - masa_eval_2d_exact_t(xmin+(j+1)*h, ymin-h);</span>
<span class="lineNum">     158 </span>            :         }
<span class="lineNum">     159 </span>            : 
<span class="lineNum">     160 </span>            :         // set the parameters for second last row of first block row
<span class="lineNum">     161 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[N-3] = (double *)malloc(6*sizeof(double));</span>
<span class="lineNum">     162 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[N-3], (double [6]){ 1, -16, 60, -16, -16, 1}, 6*sizeof(double));</span>
<span class="lineNum">     163 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[N-3] = (int *)malloc(6*sizeof(int));</span>
<span class="lineNum">     164 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[N-3], (int [6]){ N-5, N-4, N-3, N-2, 2*N-4, 3*N-5}, 6*sizeof(int));</span>
<span class="lineNum">     165 </span><span class="lineCov">          1 :         solver-&gt;length[N-3] = 6;</span>
<span class="lineNum">     166 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[N-3] = masa_eval_2d_source_t(xmin+(N-2)*h, ymin+h)*12*c + 16*masa_eval_2d_exact_t(xmin+(N-2)*h, ymin) - masa_eval_2d_exact_t(xmax, ymin+h) - masa_eval_2d_exact_t(xmin+(N-2)*h, ymin-h);</span>
<span class="lineNum">     167 </span>            : 
<span class="lineNum">     168 </span>            :         // set the parameters for last row of first block row
<span class="lineNum">     169 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[N-2] = (double *)malloc(5*sizeof(double));</span>
<span class="lineNum">     170 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[N-2], (double [5]){ 1, -16, 60, -16, 1}, 5*sizeof(double));</span>
<span class="lineNum">     171 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[N-2] = (int *)malloc(5*sizeof(int));</span>
<span class="lineNum">     172 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[N-2], (int [5]){ N-4, N-3, N-2, 2*N-3, 3*N-4}, 5*sizeof(int));</span>
<span class="lineNum">     173 </span><span class="lineCov">          1 :         solver-&gt;length[N-2] = 5;</span>
<span class="lineNum">     174 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[N-2] = masa_eval_2d_source_t(xmin+(N-1)*h, ymin+h)*12*c + 16*masa_eval_2d_exact_t(xmin+(N-1)*h, ymin) + 16*masa_eval_2d_exact_t(xmax, ymin+h) - masa_eval_2d_exact_t(xmin+(N-1)*h, ymin-h) - masa_eval_2d_exact_t(xmax+h, ymin+h);   </span>
<span class="lineNum">     175 </span>            : 
<span class="lineNum">     176 </span>            :         // 
<span class="lineNum">     177 </span>            :         // set the parameters of second block row
<span class="lineNum">     178 </span>            :         // set the parameters for first row of second block row
<span class="lineNum">     179 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[N-1] = (double *)malloc(6*sizeof(double));</span>
<span class="lineNum">     180 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[N-1], (double [6]){ -16, 60, -16, 1, -16, 1}, 6*sizeof(double));</span>
<span class="lineNum">     181 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[N-1] = (int *)malloc(6*sizeof(int));</span>
<span class="lineNum">     182 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[N-1], (int [6]){ 0, N-1, N, N+1, 2*(N-1), 3*(N-1)}, 6*sizeof(int));</span>
<span class="lineNum">     183 </span><span class="lineCov">          1 :         solver-&gt;length[N-1] = 6;</span>
<span class="lineNum">     184 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[N-1] = masa_eval_2d_source_t(xmin+h, ymin+2*h)*12*c + 16*masa_eval_2d_exact_t(xmin, ymin+2*h) - masa_eval_2d_exact_t(xmin-h, ymin+2*h) - masa_eval_2d_exact_t(xmin+h, ymin);</span>
<span class="lineNum">     185 </span>            : 
<span class="lineNum">     186 </span>            :         // set the parameters for second row of second block row
<span class="lineNum">     187 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[N] = (double *)malloc(7*sizeof(double));</span>
<span class="lineNum">     188 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[N], (double [7]){ -16, -16, 60, -16, 1, -16, 1}, 7*sizeof(double));</span>
<span class="lineNum">     189 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[N] = (int *)malloc(7*sizeof(int));</span>
<span class="lineNum">     190 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[N], (int [7]){ 1, N-1, N, N+1, N+2, 2*N-1, 3*N-2}, 7*sizeof(int));</span>
<span class="lineNum">     191 </span><span class="lineCov">          1 :         solver-&gt;length[N] = 7;</span>
<span class="lineNum">     192 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[N] = masa_eval_2d_source_t(xmin+2*h, ymin+2*h)*12*c - masa_eval_2d_exact_t(xmin+2*h, ymin) - masa_eval_2d_exact_t(xmin, ymin+2*h);</span>
<span class="lineNum">     193 </span>            : 
<span class="lineNum">     194 </span>            :         // set the parameters for inner rows of second block row
<span class="lineNum">     195 </span><span class="lineCov">         96 :         for(int j = 2; j &lt; N-3; j++) {</span>
<span class="lineNum">     196 </span><span class="lineCov">         95 :             solver-&gt;matrix_value[N-1+j] = (double *)malloc(8*sizeof(double));</span>
<span class="lineNum">     197 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_value[N-1+j], (double [8]){ -16, 1, -16, 60, -16, 1, -16, 1}, 8*sizeof(double));</span>
<span class="lineNum">     198 </span><span class="lineCov">         95 :             solver-&gt;matrix_index[N-1+j] = (int *)malloc(8*sizeof(int));</span>
<span class="lineNum">     199 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_index[N-1+j], (int [8]){ j, N+j-3, N+j-2, N+j-1, N+j, N+j+1, 2*N+j-2, 3*N+j-3}, 8*sizeof(int));</span>
<span class="lineNum">     200 </span><span class="lineCov">         95 :             solver-&gt;length[N-1+j] = 8;</span>
<span class="lineNum">     201 </span><span class="lineCov">         95 :             solver-&gt;rht_vec[N-1+j] = masa_eval_2d_source_t(xmin+(j+1)*h, ymin+2*h)*12*c - masa_eval_2d_exact_t(xmin+(j+1)*h, ymin);</span>
<span class="lineNum">     202 </span>            :         }
<span class="lineNum">     203 </span>            : 
<span class="lineNum">     204 </span>            :         // set the parameters for second last row of second block row
<span class="lineNum">     205 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[2*N-4] = (double *)malloc(7*sizeof(double));</span>
<span class="lineNum">     206 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[2*N-4], (double [7]){ -16, 1, -16, 60, -16, -16, 1}, 7*sizeof(double));</span>
<span class="lineNum">     207 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[2*N-4] = (int *)malloc(7*sizeof(int));</span>
<span class="lineNum">     208 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[2*N-4], (int [7]){ N-3, 2*N-6, 2*N-5, 2*N-4, 2*N-3, 3*N-5, 4*N-6}, 7*sizeof(int));</span>
<span class="lineNum">     209 </span><span class="lineCov">          1 :         solver-&gt;length[2*N-4] = 7;</span>
<span class="lineNum">     210 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[2*N-4] = masa_eval_2d_source_t(xmin+(N-2)*h, ymin+2*h)*12*c - masa_eval_2d_exact_t(xmax, ymin+2*h) - masa_eval_2d_exact_t(xmin+(N-2)*h, ymin);</span>
<span class="lineNum">     211 </span>            : 
<span class="lineNum">     212 </span>            :         // set the parameters for last row of second block row
<span class="lineNum">     213 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[2*N-3] = (double *)malloc(6*sizeof(double));</span>
<span class="lineNum">     214 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[2*N-3], (double [6]){ -16, 1, -16, 60, -16, 1}, 6*sizeof(double));</span>
<span class="lineNum">     215 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[2*N-3] = (int *)malloc(6*sizeof(int));</span>
<span class="lineNum">     216 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[2*N-3], (int [6]){ N-2, 2*N-5, 2*N-4, 2*N-3, 3*N-4, 4*N-5}, 6*sizeof(int));</span>
<span class="lineNum">     217 </span><span class="lineCov">          1 :         solver-&gt;length[2*N-3] = 6;</span>
<span class="lineNum">     218 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[2*N-3] = masa_eval_2d_source_t(xmin+(N-1)*h, ymin+2*h)*12*c + 16*masa_eval_2d_exact_t(xmax, ymin+2*h) - masa_eval_2d_exact_t(xmax+h, ymin+2*h) - masa_eval_2d_exact_t(xmin+(N-1)*h, ymin);</span>
<span class="lineNum">     219 </span>            : 
<span class="lineNum">     220 </span>            :         // 
<span class="lineNum">     221 </span>            :         // set the parameters of inner block rows
<span class="lineNum">     222 </span><span class="lineCov">         96 :         for(int i = 2; i &lt; N-3; i++) {</span>
<span class="lineNum">     223 </span>            :             // set the parameters for first row of inner block rows
<span class="lineNum">     224 </span><span class="lineCov">         95 :             solver-&gt;matrix_value[i*(N-1)] = (double *)malloc(7*sizeof(double));</span>
<span class="lineNum">     225 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_value[i*(N-1)], (double [7]){ 1, -16, 60, -16, 1, -16, 1}, 7*sizeof(double));</span>
<span class="lineNum">     226 </span><span class="lineCov">         95 :             solver-&gt;matrix_index[i*(N-1)] = (int *)malloc(7*sizeof(int));</span>
<span class="lineNum">     227 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_index[i*(N-1)], (int [7]){ (i-2)*(N-1), (i-1)*(N-1),i*(N-1), i*(N-1)+1, i*(N-1)+2, (i+1)*(N-1), (i+2)*(N-1)}, 7*sizeof(int));</span>
<span class="lineNum">     228 </span><span class="lineCov">         95 :             solver-&gt;length[i*(N-1)] = 7;</span>
<span class="lineNum">     229 </span><span class="lineCov">         95 :             solver-&gt;rht_vec[i*(N-1)] = masa_eval_2d_source_t(xmin+h, ymin+(i+1)*h)*12*c + 16*masa_eval_2d_exact_t(xmin, ymin+(i+1)*h) - masa_eval_2d_exact_t(xmin-h, ymin+(i+1)*h);</span>
<span class="lineNum">     230 </span>            :             // set the parameters for second row of inner block rows
<span class="lineNum">     231 </span><span class="lineCov">         95 :             solver-&gt;matrix_value[i*(N-1)+1] = (double *)malloc(8*sizeof(double));</span>
<span class="lineNum">     232 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_value[i*(N-1)+1], (double [8]){ 1, -16, -16, 60, -16, 1, -16, 1}, 8*sizeof(double));</span>
<span class="lineNum">     233 </span><span class="lineCov">         95 :             solver-&gt;matrix_index[i*(N-1)+1] = (int *)malloc(8*sizeof(int));</span>
<span class="lineNum">     234 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_index[i*(N-1)+1], (int [8]){ (i-2)*(N-1)+1, (i-1)*(N-1)+1, i*(N-1), i*(N-1)+1, i*(N-1)+2, i*(N-1)+3, (i+1)*(N-1)+1, (i+2)*(N-1)+1}, 8*sizeof(int));</span>
<span class="lineNum">     235 </span><span class="lineCov">         95 :             solver-&gt;length[i*(N-1)+1] = 8;</span>
<span class="lineNum">     236 </span><span class="lineCov">         95 :             solver-&gt;rht_vec[i*(N-1)+1] = masa_eval_2d_source_t(xmin+2*h, ymin+(i+1)*h)*12*c - masa_eval_2d_exact_t(xmin, ymin+(i+1)*h);</span>
<span class="lineNum">     237 </span>            : 
<span class="lineNum">     238 </span>            :             // set the parameters for inner rows of inner block rows
<span class="lineNum">     239 </span><span class="lineCov">       9120 :             for(int j = 2; j &lt; N-3; j++) {</span>
<span class="lineNum">     240 </span><span class="lineCov">       9025 :                 solver-&gt;matrix_value[i*(N-1)+j] = (double *)malloc(9*sizeof(double));</span>
<span class="lineNum">     241 </span><span class="lineCov">       9025 :                 memcpy(solver-&gt;matrix_value[i*(N-1)+j], (double [9]){ 1, -16, 1, -16, 60, -16, 1, -16, 1}, 9*sizeof(double));</span>
<span class="lineNum">     242 </span><span class="lineCov">       9025 :                 solver-&gt;matrix_index[i*(N-1)+j] = (int *)malloc(9*sizeof(int));</span>
<span class="lineNum">     243 </span><span class="lineCov">       9025 :                 memcpy(solver-&gt;matrix_index[i*(N-1)+j], (int [9]){ (i-2)*(N-1)+j, (i-1)*(N-1)+j, i*(N-1)+j-2, i*(N-1)+j-1, i*(N-1)+j, i*(N-1)+j+1, i*(N-1)+j+2, (i+1)*(N-1)+j, (i+2)*(N-1)+j}, 9*sizeof(int));</span>
<span class="lineNum">     244 </span><span class="lineCov">       9025 :                 solver-&gt;length[i*(N-1)+j] = 9;</span>
<span class="lineNum">     245 </span><span class="lineCov">       9025 :                 solver-&gt;rht_vec[i*(N-1)+j] = masa_eval_2d_source_t(xmin+(j+1)*h, ymin+(i+1)*h)*12*c;</span>
<span class="lineNum">     246 </span>            :             }
<span class="lineNum">     247 </span>            : 
<span class="lineNum">     248 </span>            :             // set the parameters for second last row of inner block rows
<span class="lineNum">     249 </span><span class="lineCov">         95 :             solver-&gt;matrix_value[i*(N-1)+N-3] = (double *)malloc(8*sizeof(double));</span>
<span class="lineNum">     250 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_value[i*(N-1)+N-3], (double [8]){ 1, -16, 1, -16, 60, -16, -16, 1}, 8*sizeof(double));</span>
<span class="lineNum">     251 </span><span class="lineCov">         95 :             solver-&gt;matrix_index[i*(N-1)+N-3] = (int *)malloc(8*sizeof(int));</span>
<span class="lineNum">     252 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_index[i*(N-1)+N-3], (int [8]){ (i-2)*(N-1)+N-3, (i-1)*(N-1)+N-3, i*(N-1)+N-5, i*(N-1)+N-4, i*(N-1)+N-3, i*(N-1)+N-2, (i+1)*(N-1)+N-3, (i+2)*(N-1)+N-3}, 8*sizeof(int));</span>
<span class="lineNum">     253 </span><span class="lineCov">         95 :             solver-&gt;length[i*(N-1)+N-3] = 8;</span>
<span class="lineNum">     254 </span><span class="lineCov">         95 :             solver-&gt;rht_vec[i*(N-1)+N-3] = masa_eval_2d_source_t(xmin+(N-2)*h, ymin+(i+1)*h)*12*c - masa_eval_2d_exact_t(xmax, ymin+(i+1)*h);</span>
<span class="lineNum">     255 </span>            : 
<span class="lineNum">     256 </span>            :             // set the parameters for last row of inner block rows
<span class="lineNum">     257 </span><span class="lineCov">         95 :             solver-&gt;matrix_value[i*(N-1)+N-2] = (double *)malloc(7*sizeof(double));</span>
<span class="lineNum">     258 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_value[i*(N-1)+N-2], (double [7]){ 1, -16, 1, -16, 60, -16, 1}, 7*sizeof(double));</span>
<span class="lineNum">     259 </span><span class="lineCov">         95 :             solver-&gt;matrix_index[i*(N-1)+N-2] = (int *)malloc(7*sizeof(int));</span>
<span class="lineNum">     260 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_index[i*(N-1)+N-2], (int [7]){ (i-2)*(N-1)+N-2, (i-1)*(N-1)+N-2, i*(N-1)+N-4, i*(N-1)+N-3, i*(N-1)+N-2, (i+1)*(N-1)+N-2, (i+2)*(N-1)+N-2}, 7*sizeof(int));</span>
<span class="lineNum">     261 </span><span class="lineCov">         95 :             solver-&gt;length[i*(N-1)+N-2] = 7;</span>
<span class="lineNum">     262 </span><span class="lineCov">         95 :             solver-&gt;rht_vec[i*(N-1)+N-2] = masa_eval_2d_source_t(xmin+(N-1)*h, ymin+(i+1)*h)*12*c + 16*masa_eval_2d_exact_t(xmax, ymin+(i+1)*h) - masa_eval_2d_exact_t(xmax+h, ymin+(i+1)*h);</span>
<span class="lineNum">     263 </span>            : 
<span class="lineNum">     264 </span>            :         }
<span class="lineNum">     265 </span>            : 
<span class="lineNum">     266 </span>            :         // 
<span class="lineNum">     267 </span>            :         // set the parameters of second last block row
<span class="lineNum">     268 </span>            :         // set the parameters for first row of second last block row
<span class="lineNum">     269 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[(N-3)*(N-1)] = (double *)malloc(6*sizeof(double));</span>
<span class="lineNum">     270 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[(N-3)*(N-1)], (double [6]){ 1, -16, 60, -16, 1, -16}, 6*sizeof(double));</span>
<span class="lineNum">     271 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[(N-3)*(N-1)] = (int *)malloc(6*sizeof(int));</span>
<span class="lineNum">     272 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[(N-3)*(N-1)], (int [6]){ (N-5)*(N-1), (N-4)*(N-1), (N-3)*(N-1), (N-3)*(N-1)+1, (N-3)*(N-1)+2, (N-2)*(N-1)}, 6*sizeof(int));</span>
<span class="lineNum">     273 </span><span class="lineCov">          1 :         solver-&gt;length[(N-3)*(N-1)] = 6;</span>
<span class="lineNum">     274 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[(N-3)*(N-1)] = masa_eval_2d_source_t(xmin+h, ymin+(N-2)*h)*12*c + 16*masa_eval_2d_exact_t(xmin, ymin+(N-2)*h) - masa_eval_2d_exact_t(xmin-h, ymin+(N-2)*h) - masa_eval_2d_exact_t(xmin+h, ymax);</span>
<span class="lineNum">     275 </span>            : 
<span class="lineNum">     276 </span>            :         // set the parameters for second row of second last block row
<span class="lineNum">     277 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[(N-3)*(N-1)+1] = (double *)malloc(7*sizeof(double));</span>
<span class="lineNum">     278 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[(N-3)*(N-1)+1], (double [7]){ 1, -16, -16, 60, -16, 1, -16}, 7*sizeof(double));</span>
<span class="lineNum">     279 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[(N-3)*(N-1)+1] = (int *)malloc(7*sizeof(int));</span>
<span class="lineNum">     280 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[(N-3)*(N-1)+1], (int [7]){ (N-5)*(N-1)+1, (N-4)*(N-1)+1, (N-3)*(N-1), (N-3)*(N-1)+1, (N-3)*(N-1)+2, (N-3)*(N-1)+3, (N-2)*(N-1)+1}, 7*sizeof(int));</span>
<span class="lineNum">     281 </span><span class="lineCov">          1 :         solver-&gt;length[(N-3)*(N-1)+1] = 7;</span>
<span class="lineNum">     282 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[(N-3)*(N-1)+1] = masa_eval_2d_source_t(xmin+2*h, ymin+(N-2)*h)*12*c - masa_eval_2d_exact_t(xmin, ymin+(N-2)*h) - masa_eval_2d_exact_t(xmin+2*h, ymax);</span>
<span class="lineNum">     283 </span>            : 
<span class="lineNum">     284 </span>            :         // set the parameters for inner rows of second last block row
<span class="lineNum">     285 </span><span class="lineCov">         96 :         for(int j = 2; j &lt; N-3; j++) {</span>
<span class="lineNum">     286 </span><span class="lineCov">         95 :             solver-&gt;matrix_value[(N-3)*(N-1)+j] = (double *)malloc(8*sizeof(double));</span>
<span class="lineNum">     287 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_value[(N-3)*(N-1)+j], (double [8]){ 1, -16, 1, -16, 60, -16, 1, -16}, 8*sizeof(double));</span>
<span class="lineNum">     288 </span><span class="lineCov">         95 :             solver-&gt;matrix_index[(N-3)*(N-1)+j] = (int *)malloc(8*sizeof(int));</span>
<span class="lineNum">     289 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_index[(N-3)*(N-1)+j], (int [8]){ (N-5)*(N-1)+j, (N-4)*(N-1)+j, (N-3)*(N-1)+j-2, (N-3)*(N-1)+j-1, (N-3)*(N-1)+j, (N-3)*(N-1)+j+1, (N-3)*(N-1)+j+2, (N-2)*(N-1)+j}, 8*sizeof(int));</span>
<span class="lineNum">     290 </span><span class="lineCov">         95 :             solver-&gt;length[(N-3)*(N-1)+j] = 8;</span>
<span class="lineNum">     291 </span><span class="lineCov">         95 :             solver-&gt;rht_vec[(N-3)*(N-1)+j] = masa_eval_2d_source_t(xmin+(j+1)*h, ymin+(N-2)*h)*12*c - masa_eval_2d_exact_t(xmin+(j+1)*h, ymax);</span>
<span class="lineNum">     292 </span>            :         }
<span class="lineNum">     293 </span>            : 
<span class="lineNum">     294 </span>            :         // set the parameters for second last row of second last block row
<span class="lineNum">     295 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[(N-3)*N] = (double *)malloc(7*sizeof(double));</span>
<span class="lineNum">     296 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[(N-3)*N], (double [7]){ 1, -16, 1, -16, 60, -16, -16}, 7*sizeof(double));</span>
<span class="lineNum">     297 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[(N-3)*N] = (int *)malloc(7*sizeof(int));</span>
<span class="lineNum">     298 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[(N-3)*N], (int [7]){ (N-5)*(N-1)+N-3, (N-4)*(N-1)+N-3, (N-3)*(N-1)+N-5, (N-3)*(N-1)+N-4, (N-3)*(N-1)+N-3, (N-3)*(N-1)+N-2, (N-2)*(N-1)+N-3}, 7*sizeof(int));</span>
<span class="lineNum">     299 </span><span class="lineCov">          1 :         solver-&gt;length[(N-3)*N] = 7;</span>
<span class="lineNum">     300 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[(N-3)*N] = masa_eval_2d_source_t(xmin+(N-2)*h, ymin+(N-2)*h)*12*c - masa_eval_2d_exact_t(xmax, ymin+(N-2)*h) - masa_eval_2d_exact_t(xmin+(N-2)*h, ymax);</span>
<span class="lineNum">     301 </span>            : 
<span class="lineNum">     302 </span>            :         // set the parameters for last row of second last block row
<span class="lineNum">     303 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[(N-3)*N+1] = (double *)malloc(6*sizeof(double));</span>
<span class="lineNum">     304 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[(N-3)*N+1], (double [6]){ 1, -16, 1, -16, 60, -16}, 6*sizeof(double));</span>
<span class="lineNum">     305 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[(N-3)*N+1] = (int *)malloc(6*sizeof(int));</span>
<span class="lineNum">     306 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[(N-3)*N+1], (int [6]){ (N-5)*(N-1)+N-2, (N-4)*(N-1)+N-2, (N-3)*(N-1)+N-4, (N-3)*(N-1)+N-3, (N-3)*(N-1)+N-2, (N-2)*(N-1)+N-2}, 6*sizeof(int));</span>
<span class="lineNum">     307 </span><span class="lineCov">          1 :         solver-&gt;length[(N-3)*N+1] = 6;</span>
<span class="lineNum">     308 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[(N-3)*N+1] = masa_eval_2d_source_t(xmin+(N-1)*h, ymin+(N-2)*h)*12*c + 16*masa_eval_2d_exact_t(xmax, ymin+(N-2)*h) - masa_eval_2d_exact_t(xmax+h, ymin+(N-2)*h) - masa_eval_2d_exact_t(xmin+(N-1)*h, ymax);</span>
<span class="lineNum">     309 </span>            : 
<span class="lineNum">     310 </span>            :         // 
<span class="lineNum">     311 </span>            :         // set the parameters of last block row
<span class="lineNum">     312 </span>            :         // set the parameters for first row of last block row
<span class="lineNum">     313 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[(N-2)*(N-1)] = (double *)malloc(5*sizeof(double));</span>
<span class="lineNum">     314 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[(N-2)*(N-1)], (double [5]){ 1, -16, 60, -16, 1}, 5*sizeof(double));</span>
<span class="lineNum">     315 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[(N-2)*(N-1)] = (int *)malloc(5*sizeof(int));</span>
<span class="lineNum">     316 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[(N-2)*(N-1)], (int [5]){ (N-4)*(N-1), (N-3)*(N-1), (N-2)*(N-1), (N-2)*(N-1)+1, (N-2)*(N-1)+2}, 5*sizeof(int));</span>
<span class="lineNum">     317 </span><span class="lineCov">          1 :         solver-&gt;length[(N-2)*(N-1)] = 5;</span>
<span class="lineNum">     318 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[(N-2)*(N-1)] = masa_eval_2d_source_t(xmin+h, ymin+(N-1)*h)*12*c + 16*masa_eval_2d_exact_t(xmin, ymin+(N-1)*h) + 16*masa_eval_2d_exact_t(xmin+h, ymax) - masa_eval_2d_exact_t(xmin-h, ymin+(N-1)*h) - masa_eval_2d_exact_t(xmin+h, ymax+h);</span>
<span class="lineNum">     319 </span>            : 
<span class="lineNum">     320 </span>            :         // set the parameters for second row of last block row
<span class="lineNum">     321 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[(N-2)*(N-1)+1] = (double *)malloc(6*sizeof(double));</span>
<span class="lineNum">     322 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[(N-2)*(N-1)+1], (double [6]){ 1, -16, -16, 60, -16, 1}, 6*sizeof(double));</span>
<span class="lineNum">     323 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[(N-2)*(N-1)+1] = (int *)malloc(6*sizeof(int));</span>
<span class="lineNum">     324 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[(N-2)*(N-1)+1], (int [6]){ (N-4)*(N-1)+1, (N-3)*(N-1)+1, (N-2)*(N-1), (N-2)*(N-1)+1, (N-2)*(N-1)+2, (N-2)*(N-1)+3}, 6*sizeof(int));</span>
<span class="lineNum">     325 </span><span class="lineCov">          1 :         solver-&gt;length[(N-2)*(N-1)+1] = 6;</span>
<span class="lineNum">     326 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[(N-2)*(N-1)+1] = masa_eval_2d_source_t(xmin+2*h, ymin+(N-1)*h)*12*c + 16*masa_eval_2d_exact_t(xmin+2*h, ymax) - masa_eval_2d_exact_t(xmin, ymin+(N-1)*h) - masa_eval_2d_exact_t(xmin+2*h, ymax+h);</span>
<span class="lineNum">     327 </span>            : 
<span class="lineNum">     328 </span>            :         // set the parameters for inner rows of last block row
<span class="lineNum">     329 </span><span class="lineCov">         96 :         for(int j = 2; j &lt; N-3; j++) {</span>
<span class="lineNum">     330 </span><span class="lineCov">         95 :             solver-&gt;matrix_value[(N-2)*(N-1)+j] = (double *)malloc(7*sizeof(double));</span>
<span class="lineNum">     331 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_value[(N-2)*(N-1)+j], (double [7]){ 1, -16, 1, -16, 60, -16, 1}, 7*sizeof(double));</span>
<span class="lineNum">     332 </span><span class="lineCov">         95 :             solver-&gt;matrix_index[(N-2)*(N-1)+j] = (int *)malloc(7*sizeof(int));</span>
<span class="lineNum">     333 </span><span class="lineCov">         95 :             memcpy(solver-&gt;matrix_index[(N-2)*(N-1)+j], (int [7]){ (N-4)*(N-1)+j, (N-3)*(N-1)+j, (N-2)*(N-1)+j-2, (N-2)*(N-1)+j-1, (N-2)*(N-1)+j, (N-2)*(N-1)+j+1, (N-2)*(N-1)+j+2}, 7*sizeof(int));</span>
<span class="lineNum">     334 </span><span class="lineCov">         95 :             solver-&gt;length[(N-2)*(N-1)+j] = 7;</span>
<span class="lineNum">     335 </span><span class="lineCov">         95 :             solver-&gt;rht_vec[(N-2)*(N-1)+j] = masa_eval_2d_source_t(xmin+(j+1)*h, ymin+(N-1)*h)*12*c + 16*masa_eval_2d_exact_t(xmin+(j+1)*h, ymax) - masa_eval_2d_exact_t(xmin+(j+1)*h, ymax+h);</span>
<span class="lineNum">     336 </span>            :         }
<span class="lineNum">     337 </span>            : 
<span class="lineNum">     338 </span>            :         // set the parameters for second last row of last block row
<span class="lineNum">     339 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[(N-2)*(N-1)+N-3] = (double *)malloc(6*sizeof(double));</span>
<span class="lineNum">     340 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[(N-2)*(N-1)+N-3], (double [6]){ 1, -16, 1, -16, 60, -16}, 6*sizeof(double));</span>
<span class="lineNum">     341 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[(N-2)*(N-1)+N-3] = (int *)malloc(6*sizeof(int));</span>
<span class="lineNum">     342 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[(N-2)*(N-1)+N-3], (int [6]){ (N-4)*(N-1)+N-3, (N-3)*(N-1)+N-3, (N-2)*(N-1)+N-5, (N-2)*(N-1)+N-4, (N-2)*(N-1)+N-3, (N-2)*(N-1)+N-2}, 6*sizeof(int));</span>
<span class="lineNum">     343 </span><span class="lineCov">          1 :         solver-&gt;length[(N-2)*(N-1)+N-3] = 6;</span>
<span class="lineNum">     344 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[(N-2)*(N-1)+N-3] = masa_eval_2d_source_t(xmin+(N-2)*h, ymin+(N-1)*h)*12*c + 16*masa_eval_2d_exact_t(xmin+(N-2)*h, ymax) - masa_eval_2d_exact_t(xmax, ymin+(N-1)*h) - masa_eval_2d_exact_t(xmin+(N-2)*h, ymax+h);</span>
<span class="lineNum">     345 </span>            : 
<span class="lineNum">     346 </span>            :         // set the parameters for last row of last block row
<span class="lineNum">     347 </span><span class="lineCov">          1 :         solver-&gt;matrix_value[(N-2)*N] = (double *)malloc(5*sizeof(double));</span>
<span class="lineNum">     348 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_value[(N-2)*N], (double [5]){ 1, -16, 1, -16, 60}, 5*sizeof(double));</span>
<span class="lineNum">     349 </span><span class="lineCov">          1 :         solver-&gt;matrix_index[(N-2)*N] = (int *)malloc(5*sizeof(int));</span>
<span class="lineNum">     350 </span><span class="lineCov">          1 :         memcpy(solver-&gt;matrix_index[(N-2)*N], (int [5]){ (N-4)*(N-1)+N-2, (N-3)*(N-1)+N-2, (N-2)*(N-1)+N-4, (N-2)*(N-1)+N-3, (N-2)*(N-1)+N-2}, 5*sizeof(int));</span>
<span class="lineNum">     351 </span><span class="lineCov">          1 :         solver-&gt;length[(N-2)*N] = 5;</span>
<span class="lineNum">     352 </span><span class="lineCov">          1 :         solver-&gt;rht_vec[(N-2)*N] = masa_eval_2d_source_t(xmin+(N-1)*h, ymin+(N-1)*h)*12*c + 16*masa_eval_2d_exact_t(xmin+(N-1)*h, ymax) + 16*masa_eval_2d_exact_t(xmax, ymin+(N-1)*h) - masa_eval_2d_exact_t(xmin+(N-1)*h, ymax+h) - masa_eval_2d_exact_t(xmax+h, ymin+(N-1)*h);</span>
<span class="lineNum">     353 </span>            : 
<span class="lineNum">     354 </span>            :     }
<span class="lineNum">     355 </span>            : 
<span class="lineNum">     356 </span><span class="lineCov">          3 :     if(solver-&gt;output_mode == 1) {</span>
<span class="lineNum">     357 </span><span class="lineNoCov">          0 :         show_linear_system(solver);</span>
<span class="lineNum">     358 </span><span class="lineNoCov">          0 :         printf(&quot;[debug]: build linear system - function end\n\n\n&quot;);</span>
<span class="lineNum">     359 </span>            :     }
<span class="lineNum">     360 </span>            : 
<span class="lineNum">     361 </span><span class="lineCov">          3 :     grvy_timer_end(__func__);</span>
<span class="lineNum">     362 </span>            : 
<span class="lineNum">     363 </span><span class="lineCov">          3 : }</span>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.13</a></td></tr>
  </table>
  <br>

</body>
</html>
